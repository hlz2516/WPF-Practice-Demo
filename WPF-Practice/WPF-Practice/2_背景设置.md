# 背景设置

## 需求分析

需求：先看图片  ![背景设置UI草图](./Images/背景图片设置UI草图.png)  
1. 双击图片列表中的图片框，将该图片设置为应用的背景图。注意，第一张图片为白底图，用于还原初始背景。
2 点击“添加”按钮添加图片，点击“删除”按钮删除选中的图片
3. 窗体最大化时，应将图片框大小放大一些，同理对于窗体小化

分析：可以使用wrapanel作为图片列表容器，因为wrappanel的特点是如果当前行/列空间不足，会自动切换到下一行/列来放置子控件。
对于图片框大小自适应功能，可以在wrappanel高度变化时实时改变所有内部图片框的大小。对于应用背景图片功能，可以给该用户控件
自定义一个改变背景图片事件，然后让外面的tabcontrol监听这个事件，事件触发时执行一个改变自身背景图片的方法。其他功能无难点。

## 研究核心难点
1. 研究如何给用户控件自定义路由事件，触发事件时如何把图片参数带过去(书上8.3.2 自定义路由事件)   
经过研究，过程如下：
	- 创建RoutedEventArgs的子类，用于传递图片参数
	- 在用户控件里声明和注册路由事件，假设这个事件叫设置背景事件
	- 外部控件订阅该事件并编写对应的事件处理程序
小实验：能否像winform那样自定义事件使用？不能，因为addhandler方法只支持routedevent参数
2. 研究图片框如何随父容器大小自适应  
经过研究，给wrappanel注册一个sizechanged事件，在对应事件处理程序里改变图片框大小  
3. 图像边框在点击后高亮，之前点击的回到普通状态

## 实践过程中的小问题
- 背景图片被tablcontrol的内容区域完全遮挡
	- 设置TabControl的背景为透明，tabitem的背景为透明即可。